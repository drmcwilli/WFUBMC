\hypertarget{classZaykin}{
\section{Zaykin Class Reference}
\label{classZaykin}\index{Zaykin@{Zaykin}}
}


{\ttfamily \#include $<$zaykin.hh$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classZaykin_a63cb6e8305dab0de45215665b45259a3}{Zaykin} ()
\item 
\hyperlink{classZaykin_a29f455c179a9dddc260fc6a580be2611}{$\sim$Zaykin} ()
\item 
void \hyperlink{classZaykin_a8f1f7c88b1f685b6d76b221e5fabe1d5}{setup} (const vector$<$ \hyperlink{structEMPersonalProbsResults}{EMPersonalProbsResults} $>$ \&, int numHaps, bool reweight)
\item 
\hyperlink{classZaykinGlobalStatsResults}{ZaykinGlobalStatsResults} \hyperlink{classZaykin_a61d28f9390301515bd9a47f8e6d631fb}{runGlobal} ()
\item 
vector$<$ double $>$ \hyperlink{classZaykin_a5afe5c8d000df0e1dce66d4a22891623}{runAllIndiv} (vector$<$ double $>$ \&testStats, vector$<$ int $>$ \&degsFreedom)
\item 
vector$<$ \hyperlink{classZaykinStatsInfo}{ZaykinStatsInfo} $>$ \hyperlink{classZaykin_af949cdfef60f62921b1128017c2dcc1d}{runAllHaplotypes} ()
\item 
void \hyperlink{classZaykin_afaa2e550bb5c905c428efc59dcef97f1}{setPhenotype} (const vector$<$ double $>$ \&p, const vector$<$ vector$<$ double $>$ $>$ \&c)
\item 
void \hyperlink{classZaykin_a61bed374552233240a4cd9e6df612976}{setKeepThresh} (int k)
\item 
void \hyperlink{classZaykin_a4bc760635a1333aedbc911244d543dc6}{setErrorInformation} (int \hyperlink{classZaykin_a03181d0afbfb93c0206e5c679561cafb}{snp}, int \hyperlink{classZaykin_ad0b5f025c5cffe4ef14f1685e956faa5}{numCovariates}, \hyperlink{classDataAccess}{DataAccess} $\ast$\hyperlink{classZaykin_a08bb927fb1ddebabaa02cfc3fe3c21b2}{data})
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static int \hyperlink{classZaykin_ac26fd52252bbba304828e69e44d0a909}{test} ()
\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{classZaykin_aaaee27a7e56db508adf3f2c9bb9229d4}{recode12\_\-01} (int i)
\item 
void \hyperlink{classZaykin_a3a3b137409b8c862a66c70ce199721f6}{dump} (vector$<$ vector$<$ double $>$ $>$ m)
\item 
void \hyperlink{classZaykin_a769d85be4c6a2e177db4ae826259b5a1}{prepHaplotypes} (vector$<$ double $>$ \&ones, vector$<$ vector$<$ double $>$ $>$ \&haps)
\item 
\hyperlink{classZaykinStatsInfo}{ZaykinStatsInfo} \hyperlink{classZaykin_a48c7abad236fd142ec7da0e17da86356}{runLikelihoodRatio} (const vector$<$ double $>$ \&haps, const vector$<$ double $>$ \&ones)
\item 
void \hyperlink{classZaykin_aca4c79d7edc3bf5a62c73eb95d0ffb28}{handleException} (\hyperlink{classStatsFillable}{StatsFillable} \&stats, double \&startVal, int \&retry, const string \&message)
\end{DoxyCompactItemize}
\subsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
vector$<$ double $>$ \hyperlink{classZaykin_a19b6fa76c263b5eb7793957770bd4e22}{phenotype}
\item 
vector$<$ vector$<$ double $>$ $>$ \hyperlink{classZaykin_a7ab5edcff9494a41aef72ce33926bcb4}{cov}
\item 
vector$<$ vector$<$ double $>$ $>$ \hyperlink{classZaykin_ad86108c46b3feda98fd722146df86cec}{matrix}
\item 
vector$<$ bool $>$ \hyperlink{classZaykin_a7f47e07456e480212833d09b732be913}{usedHaplotype}
\item 
int \hyperlink{classZaykin_aae179a8aaed20ab73b219763a8bd8495}{keepThresh}
\item 
int \hyperlink{classZaykin_a03181d0afbfb93c0206e5c679561cafb}{snp}
\item 
int \hyperlink{classZaykin_ad0b5f025c5cffe4ef14f1685e956faa5}{numCovariates}
\item 
\hyperlink{classDataAccess}{DataAccess} $\ast$ \hyperlink{classZaykin_a08bb927fb1ddebabaa02cfc3fe3c21b2}{data}
\end{DoxyCompactItemize}
\subsection*{Friends}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classZaykin_ab5eb8e85b324a9728c593bdc1ada8198}{HaploStats}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Computation engine for Zaykin's method for haplo-\/genotype analysis.

Performs dom, add, rec tests per haplotype. Performs global test.

Requires that a phenotype and covariates be entered. Will cull haplotypes with global freq $<$ 0.05 and will either reweight the rest or keep the same depending on user flags.

\begin{DoxyAuthor}{Author}
Richard T. Guy 
\end{DoxyAuthor}


\subsection{Constructor \& Destructor Documentation}
\hypertarget{classZaykin_a63cb6e8305dab0de45215665b45259a3}{
\index{Zaykin@{Zaykin}!Zaykin@{Zaykin}}
\index{Zaykin@{Zaykin}!Zaykin@{Zaykin}}
\subsubsection[{Zaykin}]{\setlength{\rightskip}{0pt plus 5cm}Zaykin::Zaykin ()}}
\label{classZaykin_a63cb6e8305dab0de45215665b45259a3}
\hypertarget{classZaykin_a29f455c179a9dddc260fc6a580be2611}{
\index{Zaykin@{Zaykin}!$\sim$Zaykin@{$\sim$Zaykin}}
\index{$\sim$Zaykin@{$\sim$Zaykin}!Zaykin@{Zaykin}}
\subsubsection[{$\sim$Zaykin}]{\setlength{\rightskip}{0pt plus 5cm}Zaykin::$\sim$Zaykin ()}}
\label{classZaykin_a29f455c179a9dddc260fc6a580be2611}


\subsection{Member Function Documentation}
\hypertarget{classZaykin_a3a3b137409b8c862a66c70ce199721f6}{
\index{Zaykin@{Zaykin}!dump@{dump}}
\index{dump@{dump}!Zaykin@{Zaykin}}
\subsubsection[{dump}]{\setlength{\rightskip}{0pt plus 5cm}void Zaykin::dump (vector$<$ vector$<$ double $>$ $>$ {\em m})\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classZaykin_a3a3b137409b8c862a66c70ce199721f6}
Dump a vector to the screen for testing purposes only.


\begin{DoxyParams}{Parameters}
\item[{\em m}]A double vector to be printed. \end{DoxyParams}
\hypertarget{classZaykin_aca4c79d7edc3bf5a62c73eb95d0ffb28}{
\index{Zaykin@{Zaykin}!handleException@{handleException}}
\index{handleException@{handleException}!Zaykin@{Zaykin}}
\subsubsection[{handleException}]{\setlength{\rightskip}{0pt plus 5cm}void Zaykin::handleException ({\bf StatsFillable} \& {\em stats}, \/  double \& {\em startVal}, \/  int \& {\em retry}, \/  const string \& {\em message})\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classZaykin_aca4c79d7edc3bf5a62c73eb95d0ffb28}
\hypertarget{classZaykin_a769d85be4c6a2e177db4ae826259b5a1}{
\index{Zaykin@{Zaykin}!prepHaplotypes@{prepHaplotypes}}
\index{prepHaplotypes@{prepHaplotypes}!Zaykin@{Zaykin}}
\subsubsection[{prepHaplotypes}]{\setlength{\rightskip}{0pt plus 5cm}void Zaykin::prepHaplotypes (vector$<$ double $>$ \& {\em ones}, \/  vector$<$ vector$<$ double $>$ $>$ \& {\em haps})\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classZaykin_a769d85be4c6a2e177db4ae826259b5a1}
Prepare haplotypes. \hypertarget{classZaykin_aaaee27a7e56db508adf3f2c9bb9229d4}{
\index{Zaykin@{Zaykin}!recode12\_\-01@{recode12\_\-01}}
\index{recode12\_\-01@{recode12\_\-01}!Zaykin@{Zaykin}}
\subsubsection[{recode12\_\-01}]{\setlength{\rightskip}{0pt plus 5cm}int Zaykin::recode12\_\-01 (int {\em i})\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classZaykin_aaaee27a7e56db508adf3f2c9bb9229d4}
\hypertarget{classZaykin_af949cdfef60f62921b1128017c2dcc1d}{
\index{Zaykin@{Zaykin}!runAllHaplotypes@{runAllHaplotypes}}
\index{runAllHaplotypes@{runAllHaplotypes}!Zaykin@{Zaykin}}
\subsubsection[{runAllHaplotypes}]{\setlength{\rightskip}{0pt plus 5cm}vector$<$ {\bf ZaykinStatsInfo} $>$ Zaykin::runAllHaplotypes ()}}
\label{classZaykin_af949cdfef60f62921b1128017c2dcc1d}
Run each haplotype using Zaykin's method.

Assumes that usedHaplotype was set. \hypertarget{classZaykin_a5afe5c8d000df0e1dce66d4a22891623}{
\index{Zaykin@{Zaykin}!runAllIndiv@{runAllIndiv}}
\index{runAllIndiv@{runAllIndiv}!Zaykin@{Zaykin}}
\subsubsection[{runAllIndiv}]{\setlength{\rightskip}{0pt plus 5cm}vector$<$ double $>$ Zaykin::runAllIndiv (vector$<$ double $>$ \& {\em testStats}, \/  vector$<$ int $>$ \& {\em degsFreedom})}}
\label{classZaykin_a5afe5c8d000df0e1dce66d4a22891623}
Run all individual tests to test dom, add, rec relationship with each phenotype that had enough elements.

\begin{DoxyReturn}{Returns}
vector of pValues, one per person.
\end{DoxyReturn}
\begin{Desc}
\item[\hyperlink{bug__bug000003}{Bug}]This method not done yet. \end{Desc}
\hypertarget{classZaykin_a61d28f9390301515bd9a47f8e6d631fb}{
\index{Zaykin@{Zaykin}!runGlobal@{runGlobal}}
\index{runGlobal@{runGlobal}!Zaykin@{Zaykin}}
\subsubsection[{runGlobal}]{\setlength{\rightskip}{0pt plus 5cm}{\bf ZaykinGlobalStatsResults} Zaykin::runGlobal ()}}
\label{classZaykin_a61d28f9390301515bd9a47f8e6d631fb}
Run the global analysis. Put all data and covariates in a logistic regression model.

Compute likelihood ratio statistic. This uses a likelihood statistic where n-\/1 haplotypes are tested.

\begin{DoxyReturn}{Returns}
pvalue. 
\end{DoxyReturn}
\hypertarget{classZaykin_a48c7abad236fd142ec7da0e17da86356}{
\index{Zaykin@{Zaykin}!runLikelihoodRatio@{runLikelihoodRatio}}
\index{runLikelihoodRatio@{runLikelihoodRatio}!Zaykin@{Zaykin}}
\subsubsection[{runLikelihoodRatio}]{\setlength{\rightskip}{0pt plus 5cm}{\bf ZaykinStatsInfo} Zaykin::runLikelihoodRatio (const vector$<$ double $>$ \& {\em haps}, \/  const vector$<$ double $>$ \& {\em ones})\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classZaykin_a48c7abad236fd142ec7da0e17da86356}
Run a single likelihood ratio test. Assumes covariates and phenotype are set as global variables. The test is performed on the haps vector.


\begin{DoxyParams}{Parameters}
\item[{\em haps}]Haplotype variable. H\_\-0 is that this vector is independant. \item[{\em ones}]Set of ones. Precomputed for speed. \end{DoxyParams}
\begin{DoxyReturn}{Returns}
ZaykingStatsInfo should contain all information for this likelihood ratio test. 
\end{DoxyReturn}
\hypertarget{classZaykin_a4bc760635a1333aedbc911244d543dc6}{
\index{Zaykin@{Zaykin}!setErrorInformation@{setErrorInformation}}
\index{setErrorInformation@{setErrorInformation}!Zaykin@{Zaykin}}
\subsubsection[{setErrorInformation}]{\setlength{\rightskip}{0pt plus 5cm}void Zaykin::setErrorInformation (int {\em snp}, \/  int {\em numCovariates}, \/  {\bf DataAccess} $\ast$ {\em data})}}
\label{classZaykin_a4bc760635a1333aedbc911244d543dc6}
\hypertarget{classZaykin_a61bed374552233240a4cd9e6df612976}{
\index{Zaykin@{Zaykin}!setKeepThresh@{setKeepThresh}}
\index{setKeepThresh@{setKeepThresh}!Zaykin@{Zaykin}}
\subsubsection[{setKeepThresh}]{\setlength{\rightskip}{0pt plus 5cm}void Zaykin::setKeepThresh (int {\em k})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classZaykin_a61bed374552233240a4cd9e6df612976}
Sets the keepThresh limit, which is min number of chromosomes that must contain a haplotype for it to be used in testing. 
\begin{DoxyParams}{Parameters}
\item[{\em k}]New threshold. \end{DoxyParams}
\hypertarget{classZaykin_afaa2e550bb5c905c428efc59dcef97f1}{
\index{Zaykin@{Zaykin}!setPhenotype@{setPhenotype}}
\index{setPhenotype@{setPhenotype}!Zaykin@{Zaykin}}
\subsubsection[{setPhenotype}]{\setlength{\rightskip}{0pt plus 5cm}void Zaykin::setPhenotype (const vector$<$ double $>$ \& {\em p}, \/  const vector$<$ vector$<$ double $>$ $>$ \& {\em c})}}
\label{classZaykin_afaa2e550bb5c905c428efc59dcef97f1}
\hypertarget{classZaykin_a8f1f7c88b1f685b6d76b221e5fabe1d5}{
\index{Zaykin@{Zaykin}!setup@{setup}}
\index{setup@{setup}!Zaykin@{Zaykin}}
\subsubsection[{setup}]{\setlength{\rightskip}{0pt plus 5cm}void Zaykin::setup (const vector$<$ {\bf EMPersonalProbsResults} $>$ \& {\em input}, \/  int {\em numHaps}, \/  bool {\em reweight})}}
\label{classZaykin_a8f1f7c88b1f685b6d76b221e5fabe1d5}
Retrieve data and build internal representation.

Given a series of haplogenotypes, for a given individual, calculate the prob of each haplotype involved.

The class variable matrix will be correctly filled with only those haplotypes that have greater than 0.05 global frequency. It will have been rescaled.

RTG updated Oct 14, 2010 to change the thresholding from 0.05\% global expression to showing up in at least n chromosomes (2m chr for m people). Default is 20.


\begin{DoxyParams}{Parameters}
\item[{\em input}]vector of \hyperlink{structEMPersonalProbsResults}{EMPersonalProbsResults} note that the person index is 0 based. \item[{\em numHaps}]total number of haplotypes. \item[{\em reweight}]If true, reweight the kept haplotypes. \end{DoxyParams}
\hypertarget{classZaykin_ac26fd52252bbba304828e69e44d0a909}{
\index{Zaykin@{Zaykin}!test@{test}}
\index{test@{test}!Zaykin@{Zaykin}}
\subsubsection[{test}]{\setlength{\rightskip}{0pt plus 5cm}int Zaykin::test ()\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}
\label{classZaykin_ac26fd52252bbba304828e69e44d0a909}


\subsection{Friends And Related Function Documentation}
\hypertarget{classZaykin_ab5eb8e85b324a9728c593bdc1ada8198}{
\index{Zaykin@{Zaykin}!HaploStats@{HaploStats}}
\index{HaploStats@{HaploStats}!Zaykin@{Zaykin}}
\subsubsection[{HaploStats}]{\setlength{\rightskip}{0pt plus 5cm}friend class {\bf HaploStats}\hspace{0.3cm}{\ttfamily  \mbox{[}friend\mbox{]}}}}
\label{classZaykin_ab5eb8e85b324a9728c593bdc1ada8198}


\subsection{Field Documentation}
\hypertarget{classZaykin_a7ab5edcff9494a41aef72ce33926bcb4}{
\index{Zaykin@{Zaykin}!cov@{cov}}
\index{cov@{cov}!Zaykin@{Zaykin}}
\subsubsection[{cov}]{\setlength{\rightskip}{0pt plus 5cm}vector$<$vector$<$double$>$ $>$ {\bf Zaykin::cov}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classZaykin_a7ab5edcff9494a41aef72ce33926bcb4}
\hypertarget{classZaykin_a08bb927fb1ddebabaa02cfc3fe3c21b2}{
\index{Zaykin@{Zaykin}!data@{data}}
\index{data@{data}!Zaykin@{Zaykin}}
\subsubsection[{data}]{\setlength{\rightskip}{0pt plus 5cm}{\bf DataAccess}$\ast$ {\bf Zaykin::data}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classZaykin_a08bb927fb1ddebabaa02cfc3fe3c21b2}
\hypertarget{classZaykin_aae179a8aaed20ab73b219763a8bd8495}{
\index{Zaykin@{Zaykin}!keepThresh@{keepThresh}}
\index{keepThresh@{keepThresh}!Zaykin@{Zaykin}}
\subsubsection[{keepThresh}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf Zaykin::keepThresh}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classZaykin_aae179a8aaed20ab73b219763a8bd8495}
\hypertarget{classZaykin_ad86108c46b3feda98fd722146df86cec}{
\index{Zaykin@{Zaykin}!matrix@{matrix}}
\index{matrix@{matrix}!Zaykin@{Zaykin}}
\subsubsection[{matrix}]{\setlength{\rightskip}{0pt plus 5cm}vector$<$vector$<$double$>$ $>$ {\bf Zaykin::matrix}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classZaykin_ad86108c46b3feda98fd722146df86cec}
\hypertarget{classZaykin_ad0b5f025c5cffe4ef14f1685e956faa5}{
\index{Zaykin@{Zaykin}!numCovariates@{numCovariates}}
\index{numCovariates@{numCovariates}!Zaykin@{Zaykin}}
\subsubsection[{numCovariates}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf Zaykin::numCovariates}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classZaykin_ad0b5f025c5cffe4ef14f1685e956faa5}
\hypertarget{classZaykin_a19b6fa76c263b5eb7793957770bd4e22}{
\index{Zaykin@{Zaykin}!phenotype@{phenotype}}
\index{phenotype@{phenotype}!Zaykin@{Zaykin}}
\subsubsection[{phenotype}]{\setlength{\rightskip}{0pt plus 5cm}vector$<$double$>$ {\bf Zaykin::phenotype}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classZaykin_a19b6fa76c263b5eb7793957770bd4e22}
\hypertarget{classZaykin_a03181d0afbfb93c0206e5c679561cafb}{
\index{Zaykin@{Zaykin}!snp@{snp}}
\index{snp@{snp}!Zaykin@{Zaykin}}
\subsubsection[{snp}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf Zaykin::snp}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classZaykin_a03181d0afbfb93c0206e5c679561cafb}
\hypertarget{classZaykin_a7f47e07456e480212833d09b732be913}{
\index{Zaykin@{Zaykin}!usedHaplotype@{usedHaplotype}}
\index{usedHaplotype@{usedHaplotype}!Zaykin@{Zaykin}}
\subsubsection[{usedHaplotype}]{\setlength{\rightskip}{0pt plus 5cm}vector$<$bool$>$ {\bf Zaykin::usedHaplotype}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classZaykin_a7f47e07456e480212833d09b732be913}


The documentation for this class was generated from the following files:\begin{DoxyCompactItemize}
\item 
engine/utils/\hyperlink{zaykin_8hh}{zaykin.hh}\item 
engine/utils/\hyperlink{zaykin_8cpp}{zaykin.cpp}\end{DoxyCompactItemize}
